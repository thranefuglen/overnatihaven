<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Test - Elins Overnatningshave</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c5f2d;
            margin-top: 0;
        }
        h2 {
            color: #4a7c4e;
            border-bottom: 2px solid #4a7c4e;
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background: #4a7c4e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #2c5f2d;
        }
        .response {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåø API Test - Elins Overnatningshave</h1>
        <p>Test backend API'et direkte fra denne side.</p>

        <!-- Health Check -->
        <h2>1. Health Check</h2>
        <button onclick="testHealth()">Test Health Check</button>
        <div id="healthResponse"></div>

        <!-- Check Availability -->
        <h2>2. Tjek Tilg√¶ngelighed</h2>
        <div class="form-group">
            <label>Ankomstdato:</label>
            <input type="date" id="checkArrival" value="2025-07-01">
        </div>
        <div class="form-group">
            <label>Afrejsedato:</label>
            <input type="date" id="checkDeparture" value="2025-07-03">
        </div>
        <button onclick="checkAvailability()">Tjek Tilg√¶ngelighed</button>
        <div id="availabilityResponse"></div>

        <!-- Create Inquiry -->
        <h2>3. Opret Booking Foresp√∏rgsel</h2>
        <div class="form-group">
            <label>Navn:</label>
            <input type="text" id="inquiryName" placeholder="John Doe" value="Test Bruger">
        </div>
        <div class="form-group">
            <label>Email:</label>
            <input type="email" id="inquiryEmail" placeholder="john@example.com" value="test@example.com">
        </div>
        <div class="form-group">
            <label>Telefon (valgfri):</label>
            <input type="tel" id="inquiryPhone" placeholder="+45 12345678">
        </div>
        <div class="form-group">
            <label>Ankomstdato:</label>
            <input type="date" id="inquiryArrival" value="2025-08-01">
        </div>
        <div class="form-group">
            <label>Afrejsedato:</label>
            <input type="date" id="inquiryDeparture" value="2025-08-03">
        </div>
        <div class="form-group">
            <label>Antal personer:</label>
            <input type="number" id="inquiryNumPeople" min="1" max="10" value="2">
        </div>
        <div class="form-group">
            <label>Besked (valgfri):</label>
            <textarea id="inquiryMessage" rows="3" placeholder="Vi gl√¶der os til at bes√∏ge haven!"></textarea>
        </div>
        <button onclick="createInquiry()">Opret Booking Foresp√∏rgsel</button>
        <div id="inquiryResponse"></div>

        <!-- Create Contact -->
        <h2>4. Send Kontaktbesked</h2>
        <div class="form-group">
            <label>Navn:</label>
            <input type="text" id="contactName" placeholder="Jane Doe" value="Test Bruger">
        </div>
        <div class="form-group">
            <label>Email:</label>
            <input type="email" id="contactEmail" placeholder="jane@example.com" value="test@example.com">
        </div>
        <div class="form-group">
            <label>Emne (valgfri):</label>
            <input type="text" id="contactSubject" placeholder="Sp√∏rgsm√•l om faciliteter">
        </div>
        <div class="form-group">
            <label>Besked:</label>
            <textarea id="contactMessage" rows="4" placeholder="Jeg vil gerne vide mere om...">Jeg har et sp√∏rgsm√•l om jeres smukke have.</textarea>
        </div>
        <button onclick="createContact()">Send Kontaktbesked</button>
        <div id="contactResponse"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000/api';

        function showResponse(elementId, data, isError = false) {
            const element = document.getElementById(elementId);
            const className = isError ? 'error' : 'success';
            element.innerHTML = `<div class="response ${className}">${JSON.stringify(data, null, 2)}</div>`;
        }

        async function testHealth() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                showResponse('healthResponse', data);
            } catch (error) {
                showResponse('healthResponse', { error: error.message }, true);
            }
        }

        async function checkAvailability() {
            try {
                const arrival = document.getElementById('checkArrival').value;
                const departure = document.getElementById('checkDeparture').value;
                
                const url = `${API_BASE}/inquiries/availability?arrivalDate=${arrival}&departureDate=${departure}`;
                const response = await fetch(url);
                const data = await response.json();
                
                showResponse('availabilityResponse', data, !data.success);
            } catch (error) {
                showResponse('availabilityResponse', { error: error.message }, true);
            }
        }

        async function createInquiry() {
            try {
                const data = {
                    name: document.getElementById('inquiryName').value,
                    email: document.getElementById('inquiryEmail').value,
                    phone: document.getElementById('inquiryPhone').value || undefined,
                    arrivalDate: document.getElementById('inquiryArrival').value,
                    departureDate: document.getElementById('inquiryDeparture').value,
                    numPeople: parseInt(document.getElementById('inquiryNumPeople').value),
                    message: document.getElementById('inquiryMessage').value || undefined,
                };

                const response = await fetch(`${API_BASE}/inquiries`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                showResponse('inquiryResponse', result, !result.success);
            } catch (error) {
                showResponse('inquiryResponse', { error: error.message }, true);
            }
        }

        async function createContact() {
            try {
                const data = {
                    name: document.getElementById('contactName').value,
                    email: document.getElementById('contactEmail').value,
                    subject: document.getElementById('contactSubject').value || undefined,
                    message: document.getElementById('contactMessage').value,
                };

                const response = await fetch(`${API_BASE}/contacts`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                showResponse('contactResponse', result, !result.success);
            } catch (error) {
                showResponse('contactResponse', { error: error.message }, true);
            }
        }

        // Auto-test health check on load
        window.addEventListener('load', () => {
            console.log('API Test page loaded. Testing health check...');
            testHealth();
        });
    </script>
</body>
</html>
